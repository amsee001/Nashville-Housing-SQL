-- Project utilizes Excel, MySQL, and Taleau
-- Original Excel files downloaded from https://github.com/AlexTheAnalyst/PortfolioProjects/tree/main. Excel file was formated for MySQL import
-- SQL used to clean and analyze data
-- Tableau used visualize data

SELECT *
FROM nashville_housing_cleaned;

-- Count records and unique parcels
SELECT 
    COUNT(*) AS TotalRecords,
    COUNT(DISTINCT ParcelID) AS UniqueParcels
FROM nashville_housing_cleaned;

-- Average SalePrice and TotalSales by Year
-- Tableau Data
SELECT
	SaleDate,
    COUNT(*) AS SalesCount,
    AVG(SalePrice) AS AvgPrice,
    SUM(SalePrice) AS TotalSales
FROM nashville_housing_cleaned
WHERE SaleDate < '2016-11-01'
GROUP BY SaleDate
ORDER BY SaleDate;

-- Average price by LandUse
-- Tableau Data
SELECT 
    LandUse,
    AVG(SalePrice) AS AvgPrice,
    COUNT(*) AS NumSales
FROM nashville_housing_cleaned
GROUP BY LandUse
ORDER BY AvgPrice DESC;

-- SalesPrice vs AssessedPrice
-- Tableau Data
SELECT 
	UniqueID,
    ParcelID,
    PropertyAddress,
    PropertyCity,
    SalePrice,
    TotalValue,
    (SalePrice - TotalValue) AS AssessedPrice
FROM nashville_housing_cleaned
WHERE TotalValue > 0
ORDER BY AssessedPrice DESC;

-- Bedrooms and Bathrooms in relation to AvgPrice
-- Tableau Data
SELECT
    Bedrooms,
    FullBath,
    HalfBath,
    AVG(SalePrice) AS AvgPrice
FROM nashville_housing_cleaned
WHERE Bedrooms > 0
	AND FullBath > 0
GROUP BY Bedrooms, FullBath, HalfBath
ORDER BY Bedrooms, FullBath, HalfBath;

-- Price per Acreage
-- Tableau Data
SELECT
	UniqueID,
    ParcelID,
    SalePrice,
    ROUND(Acreage, 1) AS Acreage,
    ROUND(SalePrice / Acreage) AS PricePerAcre
FROM nashville_housing_cleaned
WHERE Acreage > 0.1
ORDER BY Acreage;

-- Owners with multiple properties
-- Tableau Data
SELECT 
	LandUse,
    OwnerName,
    COUNT(*) AS PropertiesOwned
FROM nashville_housing_cleaned
WHERE OwnerName IS NOT NULL
GROUP BY OwnerName, LandUse
HAVING COUNT(*) > 1

ORDER BY PropertiesOwned DESC, OwnerName;
